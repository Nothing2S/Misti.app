<!DOCTYPE html>
<html lang="km">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>á–áŸááŸŒá˜á¶á“á›á˜áŸ’á¢á·á</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .detail-container { max-width: 920px; margin: 32px auto; background: #fff; border-radius: 16px; box-shadow: var(--shadow-lg); padding: 24px; }
    .detail-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:16px; }
    .detail-title { font-size: 1.5rem; font-weight: 800; color: var(--gray-800); }
    .detail-grid { display:grid; grid-template-columns: 1fr 2fr; gap: 12px 16px; }
    .detail-label { font-weight:700; color: var(--gray-700); }
    .detail-value { color: var(--gray-800); }
    .detail-actions { margin-top: 20px; display:flex; gap: 12px; }
    .btn { padding: 10px 16px; border-radius: 10px; border:none; cursor:pointer; font-weight:700; color:#fff; box-shadow: var(--shadow-md); }
    .btn-primary { background: linear-gradient(135deg, var(--primary-blue), var(--primary-blue-dark)); }
    .btn-secondary { background: linear-gradient(135deg, #10b981, #059669); }
    .muted { color: var(--gray-500); font-style: italic; }
  </style>
</head>
<body>
  <div class="detail-container">
    <div class="detail-header">
      <div class="detail-title">á–áŸááŸŒá˜á¶á“á›á˜áŸ’á¢á·á</div>
      <button class="btn btn-primary" onclick="goBack()">â¬… ááŸ’ášá›á”áŸ‹á€áŸ’ášáŸ„á™</button>
    </div>
    <div id="detailContent" class="detail-grid"></div>
    <div class="detail-actions" id="detailActions" hidden>
      <a id="mapLink" class="btn btn-secondary" href="#" target="_blank" rel="noopener">ğŸ—º á”á¾á€á•áŸ‚á“á‘á¸</a>
    </div>
  </div>

  <script>
    function goBack(){
      if (document.referrer) window.history.back(); else window.location.href = 'index.html';
    }

    function renderDetail(){
      let payload = null;
      try { payload = JSON.parse(localStorage.getItem('misti_detail_row')||'null'); } catch {}
      const container = document.getElementById('detailContent');
      const actions = document.getElementById('detailActions');
      const mapLink = document.getElementById('mapLink');

      if (!payload || !payload.cells) {
        container.innerHTML = '<div class="muted">á˜á·á“á˜á¶á“á‘á·á“áŸ’á“á“áŸá™á”á„áŸ’á á¶á‰á‘áŸ</div>';
        actions.hidden = true;
        return;
      }

      const frag = document.createDocumentFragment();
      payload.cells.forEach(item => {
        const label = document.createElement('div');
        label.className = 'detail-label';
        label.textContent = item.label || '';
        const value = document.createElement('div');
        value.className = 'detail-value';
        if (item.href) {
          const a = document.createElement('a');
          a.href = item.href; a.target = '_blank'; a.rel='noopener';
          a.textContent = (item.value||'').trim() || item.href;
          value.appendChild(a);
        } else {
          value.textContent = item.value || '';
        }
        frag.appendChild(label); frag.appendChild(value);
      });
      container.innerHTML = '';
      container.appendChild(frag);

      if (payload.mapLink) {
        actions.hidden = false;
        mapLink.href = payload.mapLink;
      } else {
        actions.hidden = true;
      }
    }

    document.addEventListener('DOMContentLoaded', renderDetail);
  </script>
</body>
</html>
